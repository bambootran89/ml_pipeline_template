# XGBoost Test/Inference Pipeline
# Generate predictions without evaluation
# Usage: python -m mlproject.src.pipeline.dag_run test --config configs/experiments/test_xgboost.yaml

defaults:
  - ../base/model.yaml
  - ../base/training.yaml
  - ../base/evaluation.yaml
  - ../base/mlflow.yaml

data:
  path: "mlproject/data/ETTh1.csv"
  index_col: "date"
  target_columns: ["HUFL", "MUFL"]
  features: ["HUFL", "MUFL", "mobility_inflow"]
  return_type: pandas
  type: timeseries

experiment:
  name: "xgboost_inference"
  type: "timeseries"
  model: "xgboost"
  model_type: "ml"
  hyperparams:
    input_chunk_length: 24
    output_chunk_length: 6
    n_targets: 2
    type: "regression"

# Model registry - required by DataModuleFactory
model_registry:
  xgboost:
    type: "ml"
    model_type: "ml"
    datamodule_type: "ml"

# Test/Inference Pipeline - Only predictions, no evaluation
pipeline:
  steps:
    - id: "load_data"
      type: "data_loader"
      enabled: true

    - id: "preprocess"
      type: "preprocessor"
      enabled: true
      is_train: false  # ← CRITICAL: Load saved preprocessor, don't fit!

    - id: "load_model"
      type: "model_loader"
      enabled: true
      alias: "latest"  # ← Load from MLflow Registry!

    - id: "inference"
      type: "inference"
      enabled: true
      model_step_id: "load_model"
      save_path: "mlproject/outputs/predictions.csv"
      include_inputs: false
